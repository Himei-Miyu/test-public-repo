import{ssrElement as C,escape as b,mergeProps as G,ssr as y,isServer as k,getRequestEvent as S,renderToStream as Q,createComponent as m,delegateEvents as X,ssrHydrationKey as $,useAssets as Z,NoHydration as I,HydrationScript as ee,ssrAttribute as te,Hydration as ne}from"solid-js/web";import{lazy as re,createComponent as se,sharedConfig as F,children as oe,createMemo as L,on as ae,createRoot as ie,Show as U,createSignal as ce,onCleanup as P,Suspense as le,ErrorBoundary as ue}from"solid-js";import{provideRequestEvent as de}from"solid-js/web/storage";import{getRequestURL as B,getRequestWebStream as he,getRequestIP as me,setResponseHeader as x,setResponseStatus as T,appendResponseHeader as fe,getResponseHeader as pe,removeResponseHeader as ge,getCookie as be,setCookie as ye,eventHandler as we,sendRedirect as Re,setHeader as Se}from"h3";import{c as ve,a as Ee,R as Ae,g as $e,b as ke,d as Ce,e as D,u as xe}from"./assets/routing-77c25660.js";function Le(e){let t;const r=B(e),n={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(r,{...n,body:e.node.req.body}):new Request(r,{...n,get body(){return t||(t=he(e),t)}})}function Te(e){return e.web??={request:Le(e),url:B(e)},e.web.request}const W=Symbol("h3Event"),A=Symbol("fetchEvent"),qe={get(e,t){return t===A?e:e[t]??e[W][t]}};function Pe(e){const t=Te(e);return new Proxy({request:t,clientAddress:me(e),locals:{},[W]:e},qe)}function Me(e){if(!e[A]){const t=Pe(e);e[A]=t}return e[A]}function Oe(e){e.forEach(t=>{if(!t.attrs.href)return;let r=document.head.querySelector(`link[href="${t.attrs.href}"]`);r||(r=document.createElement("link"),r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",t.attrs.href),document.head.appendChild(r))})}var Fe=" ";const He={style:e=>C("style",e.attrs,()=>b(e.children),!0),link:e=>C("link",e.attrs,void 0,!0),script:e=>e.attrs.src?C("script",G(()=>e.attrs,{get id(){return e.key}}),()=>y(Fe),!0):null};function q(e){let{tag:t,attrs:{key:r,...n}={key:void 0},children:s}=e;return He[t]({attrs:n,key:r,children:s})}function Ne(e,t,r,n="default"){return re(async()=>{{const a=(await e.import())[n],i=(await t.inputs?.[e.src].assets()).filter(p=>p.tag==="style"||p.attrs.rel==="stylesheet");return typeof window<"u"&&Oe(i),{default:p=>[...i.map(g=>q(g)),se(a,p)]}}})}const _=[{type:"page",$component:{src:"src/routes/about.tsx?pick=default&pick=$css",build:()=>import("./about.js"),import:()=>import("./about.js")},path:"/about",filePath:"C:/Users/Microsoft/Desktop/projects/solidstart-test/my-app/src/routes/about.tsx"},{type:"page",$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("./index.js"),import:()=>import("./index.js")},path:"/",filePath:"C:/Users/Microsoft/Desktop/projects/solidstart-test/my-app/src/routes/index.tsx"},{type:"page",$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("./_...404_.js"),import:()=>import("./_...404_.js")},path:"/*404",filePath:"C:/Users/Microsoft/Desktop/projects/solidstart-test/my-app/src/routes/[...404].tsx"}],je=Be(_.filter(e=>e.type==="page")),Ie=De(_.filter(e=>e.type==="api"));function Ue(e,t){const r=e.replace("","").split("/").filter(Boolean);e:for(const n of Ie){const s=n.matchSegments;if(r.length<s.length||!n.wildcard&&r.length>s.length)continue;for(let i=0;i<s.length;i++){const u=s[i];if(u&&r[i]!==u)continue e}const a=n[`$${t}`];if(a==="skip"||a===void 0)return;const o={};for(const{type:i,name:u,index:p}of n.params)i===":"?o[u]=r[p]:o[u]=r.slice(p).join("/");return{handler:a,params:o}}}function Be(e){function t(r,n,s,a){const o=Object.values(r).find(i=>s.startsWith(i.id+"/"));return o?(t(o.children||(o.children=[]),n,s.slice(o.id.length)),r):(r.push({...n,id:s,path:s.replace(/\/\([^)/]+\)/g,"")}),r)}return e.sort((r,n)=>r.path.length-n.path.length).reduce((r,n)=>t(r,n,n.path,n.path),[])}function De(e){return e.flatMap(t=>K(t.path).map(n=>({...t,path:n}))).map(We).sort((t,r)=>r.score-t.score)}function K(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let r=e.slice(0,t.index),n=e.slice(t.index+t[0].length);const s=[r,r+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(n);)s.push(r+=t[1]),n=n.slice(t[0].length);return K(n).reduce((a,o)=>[...a,...s.map(i=>i+o)],[])}function We(e){const t=e.path.split("/").filter(Boolean),r=[],n=[];let s=0,a=!1;for(const[o,i]of t.entries())if(i[0]===":"){const u=i.slice(1);s+=3,r.push({type:":",name:u,index:o}),n.push(null)}else i[0]==="*"?(s-=1,r.push({type:"*",name:i.slice(1),index:o}),a=!0):(s+=4,i.match(/^\(.+\)$/)||n.push(i));return{...e,score:s,params:r,matchSegments:n,wildcard:a}}function J(){function e(r){return{...r,...r.$$route?r.$$route.require().route:void 0,metadata:{...r.$$route?r.$$route.require().route.metadata:{},filesystem:!0},component:Ne(r.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:r.children?r.children.map(e):void 0}}return je.map(e)}let H;const _e=()=>k?S().routes:H||(H=J());function Ke(e){const t=be(e,"flash");if(!t)return;let r=JSON.parse(t);if(!r||!r.result)return[];const n=[...r.input.slice(0,-1),new Map(r.input[r.input.length-1])];return ye(e,"flash","",{maxAge:0}),{url:r.url,result:r.error?new Error(r.result):r.result,input:n}}async function z(e){const t=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,x(e,"Content-Type","text/html"),Object.assign(e,{manifest:await t.json(),assets:[...await t.inputs[t.handler].assets()],initialSubmission:Ke(e),routes:J(),components:{status:n=>(T(e,n.code,n.text),()=>T(e,200)),header:n=>(n.append?fe(e,n.name,n.value):x(e,n.name,n.value),()=>{const s=pe(e,n.name);if(s&&typeof s=="string"){const a=s.split(", "),o=a.indexOf(n.value);o!==-1&&a.splice(o,1),a.length?x(e,n.name,a.join(", ")):ge(e,n.name)}})},$islands:new Set})}function Je(e,t={}){return we({onRequest:t.onRequest,onBeforeResponse:t.onBeforeResponse,handler:r=>{const n=Me(r);return de(n,async()=>{const s=Ue(new URL(n.request.url).pathname,n.request.method);if(s){const d=(await s.handler.import())[n.request.method];return n.params=s.params,F.context={event:n},await d(n)}const a=await z(n);let o={...t};if(o.onCompleteAll){const g=o.onCompleteAll;o.onCompleteAll=d=>{j(a)(d),g(d)}}else o.onCompleteAll=j(a);if(o.onCompleteShell){const g=o.onCompleteShell;o.onCompleteShell=d=>{N(a,r)(),g(d)}}else o.onCompleteShell=N(a,r);const i=Q(()=>(F.context.event=a,e(a)),o);if(a.response&&a.response.headers.get("Location"))return Re(n,a.response.headers.get("Location"));const{writable:u,readable:p}=new TransformStream;return i.pipeTo(u),p})}})}function N(e,t){return()=>{e.response&&e.response.headers.get("Location")&&(T(t,302),Se(t,"Location",e.response.headers.get("Location")))}}function j(e){return({write:t})=>{const r=e.response&&e.response.headers.get("Location");r&&t(`<script>window.location="${r}"<\/script>`)}}function ze(e,t={}){return Je(e,{...t,createPageEvent:z})}const V=e=>t=>{const{base:r}=t,n=oe(()=>t.children),s=L(()=>ve(t.root?{component:t.root,children:n()}:n(),t.base||"")),a=Ee(e,s,{base:r});return e.create&&e.create(a),m(Ae.Provider,{value:a,get children(){return m(Ve,{routerState:a,get branches(){return s()}})}})};function Ve(e){const t=L(()=>$e(e.branches,e.routerState.location.pathname));if(k){const o=S();o&&(o.routerMatches||(o.routerMatches=[])).push(t().map(({route:i,path:u,params:p})=>({path:i.originalPath,pattern:i.pattern,match:u,params:p,metadata:i.metadata})))}const r=ke(()=>{const o=t(),i={};for(let u=0;u<o.length;u++)Object.assign(i,o[u].params);return i}),n=[];let s;const a=L(ae(t,(o,i,u)=>{let p=i&&o.length===i.length;const g=[];for(let d=0,v=o.length;d<v;d++){const w=i&&i[d],c=o[d];u&&w&&c.route.key===w.route.key?g[d]=u[d]:(p=!1,n[d]&&n[d](),ie(l=>{n[d]=l,g[d]=Ce(e.routerState,g[d-1]||e.routerState.base,Ye(()=>a()[d+1]),()=>t()[d],r)}))}return n.splice(o.length).forEach(d=>d()),u&&p?u:(s=g[0],g)}));return m(U,{get when(){return a()&&s},keyed:!0,children:o=>m(D.Provider,{value:o,get children(){return o.outlet()}})})}const Ye=e=>()=>m(U,{get when(){return e()},keyed:!0,children:t=>m(D.Provider,{value:t,get children(){return t.outlet()}})});function Ge([e,t],r,n){return[r?()=>r(e()):e,n?s=>t(n(s)):t]}function Qe(e){if(e==="#")return null;try{return document.querySelector(e)}catch{return null}}function Xe(e){let t=!1;const r=s=>typeof s=="string"?{value:s}:s,n=Ge(ce(r(e.get()),{equals:(s,a)=>s.value===a.value}),void 0,s=>(!t&&e.set(s),s));return e.init&&P(e.init((s=e.get())=>{t=!0,n[1](r(s)),t=!1})),V({signal:n,create:e.create,utils:e.utils})}function Ze(e,t,r){return e.addEventListener(t,r),()=>e.removeEventListener(t,r)}function et(e,t){const r=Qe(`#${e}`);r?r.scrollIntoView():t&&window.scrollTo(0,0)}function tt(e){const t=new URL(e);return t.pathname+t.search}function nt(e){let t;const r={value:e.url||(t=S())&&tt(t.request.url)||""};return V({signal:[()=>r,n=>Object.assign(r,n)]})(e)}const rt=new Map;function st(e=!0,t=!1,r="/_server"){return n=>{const s=n.base.path(),a=n.navigatorFactory(n.base);let o={};function i(c){return c.namespaceURI==="http://www.w3.org/2000/svg"}function u(c){if(c.defaultPrevented||c.button!==0||c.metaKey||c.altKey||c.ctrlKey||c.shiftKey)return;const l=c.composedPath().find(O=>O instanceof Node&&O.nodeName.toUpperCase()==="A");if(!l||t&&!l.getAttribute("link"))return;const f=i(l),h=f?l.href.baseVal:l.href;if((f?l.target.baseVal:l.target)||!h&&!l.hasAttribute("state"))return;const R=(l.getAttribute("rel")||"").split(/\s+/);if(l.hasAttribute("download")||R&&R.includes("external"))return;const E=f?new URL(h,document.baseURI):new URL(h);if(!(E.origin!==window.location.origin||s&&E.pathname&&!E.pathname.toLowerCase().startsWith(s.toLowerCase())))return[l,E]}function p(c){const l=u(c);if(!l)return;const[f,h]=l,M=n.parsePath(h.pathname+h.search+h.hash),R=f.getAttribute("state");c.preventDefault(),a(M,{resolve:!1,replace:f.hasAttribute("replace"),scroll:!f.hasAttribute("noscroll"),state:R&&JSON.parse(R)})}function g(c){const l=u(c);if(!l)return;const[f,h]=l;o[h.pathname]||n.preloadRoute(h,f.getAttribute("preload")!=="false")}function d(c){const l=u(c);if(!l)return;const[f,h]=l;o[h.pathname]||(o[h.pathname]=setTimeout(()=>{n.preloadRoute(h,f.getAttribute("preload")!=="false"),delete o[h.pathname]},200))}function v(c){const l=u(c);if(!l)return;const[,f]=l;o[f.pathname]&&(clearTimeout(o[f.pathname]),delete o[f.pathname])}function w(c){let l=c.submitter&&c.submitter.hasAttribute("formaction")?c.submitter.formAction:c.target.action;if(!l)return;if(!l.startsWith("https://action/")){const h=new URL(l);if(l=n.parsePath(h.pathname+h.search),!l.startsWith(r))return}if(c.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const f=rt.get(l);if(f){c.preventDefault();const h=new FormData(c.target);c.submitter&&c.submitter.name&&h.append(c.submitter.name,c.submitter.value),f.call(n,h)}}X(["click","submit"]),document.addEventListener("click",p),e&&(document.addEventListener("mouseover",d),document.addEventListener("mouseout",v),document.addEventListener("focusin",g),document.addEventListener("touchstart",g)),document.addEventListener("submit",w),P(()=>{document.removeEventListener("click",p),e&&(document.removeEventListener("mouseover",d),document.removeEventListener("mouseout",v),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",w)})}}function ot(e){return k?nt(e):Xe({get:()=>({value:window.location.pathname+window.location.search+window.location.hash,state:history.state}),set({value:t,replace:r,scroll:n,state:s}){r?window.history.replaceState(s,"",t):window.history.pushState(s,"",t),et(window.location.hash.slice(1),n)},init:t=>Ze(window,"popstate",()=>t()),create:st(e.preload,e.explicitLinks,e.actionBase),utils:{go:t=>window.history.go(t)}})(e)}function at(e){if(k){const t=S();t&&P(t.components.status(e))}return null}var it=["<nav",' class="bg-sky-800"><ul class="container flex items-center p-3 text-gray-200"><li class="','"><a href="/">Home</a></li><li class="','"><a href="/about">About</a></li></ul></nav>'];function ct(){const e=xe(),t=r=>r==e.pathname?"border-sky-600":"border-transparent hover:border-sky-600";return y(it,$(),`border-b-2 ${b(t("/"),!0)} mx-1.5 sm:mx-6`,`border-b-2 ${b(t("/about"),!0)} mx-1.5 sm:mx-6`)}function lt(){return m(ot,{root:e=>[m(ct,{}),m(le,{get children(){return e.children}})],get children(){return m(_e,{})}})}function ut(e){return m(ue,{get fallback(){return m(at,{code:500})},get children(){return e.children}})}var dt=["<script",">","<\/script>"],ht=["<script",' type="module" async',"><\/script>"];const mt=y("<!DOCTYPE html>");function Y(e,t,r=[]){for(let n=0;n<t.length;n++){const s=t[n];if(s.path!==e[0].path)continue;let a=[...r,s];if(s.children){const o=e.slice(1);if(o.length===0||(a=Y(o,s.children,a),!a))continue}return a}}function ft(e){const t=S();let r=[];return Promise.resolve().then(async()=>{if(t.routerMatches&&t.routerMatches[0]){const n=[...t.routerMatches[0]];for(;n.length&&(!n[0].metadata||!n[0].metadata.filesystem);)n.shift();const s=n.length&&Y(n,t.routes);if(s)for(let a=0;a<s.length;a++){const o=s[a],u=await globalThis.MANIFEST.client.inputs[o.$component.src].assets();r.push.apply(r,u)}else console.warn("No route matched for preloading js assets")}r=[...new Map(r.map(n=>[n.attrs.key,n])).values()].filter(n=>n.attrs.rel==="modulepreload"&&!t.assets.find(s=>s.attrs.key===n.attrs.key))}),Z(()=>r.length?r.map(n=>q(n)):void 0),m(I,{get children(){return[mt,m(e.document,{get assets(){return[m(ee,{}),t.assets.map(n=>q(n))]},get scripts(){return[y(dt,$(),`window.manifest = ${JSON.stringify(t.manifest)}`),y(ht,$(),te("src",b(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return m(ne,{get children(){return m(ut,{get children(){return m(lt,{})}})}})}})]}})}var pt=['<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico">',"</head>"],gt=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"];const vt=ze(()=>m(ft,{document:({assets:e,children:t,scripts:r})=>y(gt,$(),m(I,{get children(){return y(pt,b(e))}}),b(t),b(r))}));export{vt as default};
